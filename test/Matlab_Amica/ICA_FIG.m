N=2000;
A = [1 4;4 1];
s = gg6(2,N,[0 0],[1 3],[1.5 1.5]);
x = A*s;
[h1,b1] = hist(s(1,:),50);
[h2,b2] = hist(s(2,:),50);
figure, hold on; set(gca,'fontsize',14);
subplot(2,4,1); set(gca,'fontsize',14);
plot(s(1,:),s(2,:),'b.'); axis(4*[-1 1 -1 1]); xlabel('\its_{\rm1}'); ylabel('\its_{\rm2}');
subplot(2,4,2); set(gca,'fontsize',14);
bar(b2,h2/(N*(b2(2)-b2(1))));  axis(4*[-1 1 0 1/4]); xlabel('\its_{\rm2}'); ylabel('norm. histogram');
subplot(2,4,5); set(gca,'fontsize',14);
bar(b1,h1/(N*(b1(2)-b1(1))));  axis(4*[-1 1 0 1/4]);  xlabel('\its_{\rm1}'); ylabel('norm. histogram');
subplot(2,4,3); hold on; set(gca,'fontsize',14);
subplot(2,4,3); plot(x(1,:),x(2,:),'g.'); axis(15*[-1 1 -1 1]);
subplot(2,4,3); plot([0 A(1,1)],[0 A(2,1)],'r-','LineWidth',2);
subplot(2,4,3); plot([0 A(1,2)],[0 A(2,2)],'r-','LineWidth',2);
xlabel('\itx_{\rm1}'); ylabel('\itx_{\rm2}');
[h1,b1] = hist(x(1,:),50);
[h2,b2] = hist(x(2,:),50);
subplot(2,4,4); set(gca,'fontsize',14);
bar(b2,h2/(N*(b2(2)-b2(1))),'g');  axis([-15 15 0 0.25]); xlabel('\itx_{\rm2}'); ylabel('norm. histogram');
subplot(2,4,7); set(gca,'fontsize',14);
bar(b1,h1/(N*(b1(2)-b1(1))),'g');  axis([-15 15 0 0.25]);  xlabel('\itx_{\rm1}'); ylabel('norm. histogram');